<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:include="/credit/header" />

<body>

<section class="content-header">
    <h1 th:text="|${type == '1' ? '医疗机构' : (type == '2' ? '医疗人员' : '医疗活动相关人员')}-卫监所|"></h1>
    <ol class="breadcrumb">
        <li><a  th:href="@{'/credit/daily/operation/wjs/'+${type}}" ><i class="fa fa-table"></i>监察记录列表</a></li>
        <li class="active">添加监察记录</li>
    </ol>
</section>
<section class="content">
    <div id="model_container" class="box box-widget" >
        <div class="box-header no-border" >
            <h3 class="box-title">添加监察记录</h3>
            <div class="box-tools pull-right">
                <a class="btn tonto-model-tool-view-btn" id="model_edit_btn" href="javascript:void(0)"><i class="fa fa-edit"></i>编辑</a>
            </div>
        </div>
        <div id="model_edit" class="box-body" >
            <form id="model_form" action="/credit/supervise/record/wjs/save" method="post" class="form-horizontal null" style="padding-left:100px">
                <div class="form-group">
                    <label for="agencyId" class="col-sm-2 control-label">机构：</label>
                    <div class="col-sm-3">
                        <select name="agencyId" class="form-control">
                            <option value="">请选择</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="item" class="col-sm-2 control-label">扣分条例依据：</label>
                    <div class="col-sm-3">
                        <select  class="form-control" name="ruleName" id="scoreItem" onchange="changeScoreInput()">
                            <option value="">请选择</option>
                        </select>
                    </div>
                    <input type="hidden" id="item" name="item">
                    <label for="score" class="col-sm-2 control-label">扣除分值：</label>
                    <div class="col-sm-3">
                        <input name="score"  id="score" class="form-control" placeholder="请输入扣除分值"  type="number">
                    </div>
                </div>
                <div class="form-group">
                    <label for="scoreAttachment" class="col-sm-2 control-label">扣分决定书照片上传：</label>
                    <div name="scoreAttachment" class="col-sm-8" >
                        <input type="file" name="scoreAttachmentFiles" multiple>
                    </div>
                </div>
                <div class="form-group">
                    <label for="punishNo" class="col-sm-2 control-label">行政处罚决定书编号：</label>
                    <div class="col-sm-3">
                        <input name="punishNo" placeholder="请输入行政处罚决定书编号" type="text" class="form-control"></div>
                    <label for="punishTime" class="col-sm-2 control-label">处罚时间：</label>
                    <div class="col-sm-3">
                        <input name="punishTime" placeholder="请输入处罚时间" autocomplete="off" type="text" class="form-control tonto-datepicker-date"></div>
                </div>
                <div class="form-group">
                    <label for="punishAttachment" class="col-sm-2 control-label">处罚决定书上传：</label>
                    <div name="punishAttachment" class="col-sm-8" >
                        <input type="file" name="punishAttachmentFiles" multiple>
                    </div>
                </div>
                <div class="form-group form-button-bar">
                    <div class="col-sm-2 col-sm-offset-3">
                        <button type="submit" id="model_form_submit_btn" class="btn btn-primary btn-block">保存</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>
<div class="col-sm-2 col-sm-offset-5 btn-back">
    <a th:href="@{'/credit/daily/operation/wjs/'+${type}}" class="btn btn-primary btn-block">返回</a>
</div>
<input type="hidden" id="type" name="type" th:value="${type}">
<div th:include="/credit/footer" />
<script type="text/javascript">
    var type;
    var options = {
        id: "model",
        cancelBtn: false,
        name: "添加监察记录",
        url:"/credit/supervise/record/wjs/save",
        columns: [
            { title: "机构", name: "agencyId",  multiple: false,colspan:2, inputType: "SELECT-SERVER", url: "/credit/permission/agency/lower" },
            { title: "扣分条例依据", name: "ruleName", multiple: false, inputType: "SELECT-SERVER", url: "/credit/org/rule/management/lower/1"},
            { title: "扣除分值", name: "score", inputType: "NUMBER" },
            { title: "扣分决定书照片上传",name: "scoreAttachment", inputType: "ATTACHMENT", fileName: "scoreAttachmentFiles", maxFileCount: 5 },
            { title: "行政处罚决定书编号",name:"punishNo",inputType: "TEXT" },
            { title: "处罚时间",name: "punishTime", inputType: "DATE"},
            { title: "处罚决定书上传",name: "punishAttachment", inputType: "ATTACHMENT", fileName: "punishAttachmentFiles", maxFileCount: 5 }
        ]
    };

    $(function() {
        type = $("#type").val();
        var model = new tonto.Model("model", options.columns, {
            pattern:"edit",
            extraParam:{
                'targetType':type
            },
            successCallback:function(){
                $.successAlert("保存成功",function(){
                    window.location = "/credit/daily/operation/wjs/"+type;
                });
            }
        });
        model.setData(null);
        //$("#scoreItem").trigger("change")
    });

    function changeScoreInput() {
        let $scoreItem = $("#scoreItem option:selected");
        let item = $scoreItem.text();
        let score = $scoreItem.val();
        $("#score").val(score);
        $("#item").val(item);
    }
</script>
</body>

</html>